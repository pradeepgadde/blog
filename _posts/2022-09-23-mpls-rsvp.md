---

layout: single
title:  "Resource Reservation Protocol"
date:   2022-09-23 08:59:04 +0530
categories: Networking
tags: MPLS
show_date: true
classes: wide
header:
  teaser: /assets/images/junos.png
author:
  name     : "Junos"
  avatar   : "/assets/images/junos.png"

sidebar:
  - title: "Blog"
   
    text: "Checkout other topics"
    nav: my-sidebar

---
# RSVP
We cant build a large network with static LSPs so we need a protocol like RSVP.
RSVP still requires manual configuration on the ingress router, every other hop takes care of establishing the path.

The benefit of manul configuration is the rich set of traffic engineering capabilities
- follow the best path
- take a specific path
- reserve BW across the path
- optimize the path as topology changes

## RSVP Features
- Different priority levels
- automatic re-signalling of BW
- automatic  split of LSPs
- Backup/standby path
- local repair (protection from link/node failure)
- Tagging of links (admin-groups)
- P2MP LSPs (for multicast applications)

RSVP carry opaque objects that carry useful information like BW, labels etc which are meaningless to RSVP but useful to MPLS routers.

Routers learn about these attributes like tags, BW, priority etc from the IGP extensions.
OSPF/IS-IS are extended to carry traffic engineering information.

TE extensions are enabled by default in IS-IS.
In OSPF, we need to manually enable these TE extensions.

TE information is stored in the TED (Traffic Engineering Database).

We can configure RSVP LSPs to either use the TED or use the regular LSDB.

- Use the TED to calculate a traffic engineered path
- Use the LSDB to follow the shortest path



If we use TED, the ingress router calculates the complete path based on the constraints set and includes the path in an ERO (Explicit Route Object) when the LSP is signalled. Each router in the path obeys the ERO.



If we use the LSDB only, ingress router calculates the best path, but does not include any EROs. It decides only the next-hop but not the exact end-to-end path. Each hop runs SPF to decide the next hop.



## Configuring RSVP

- configure MPLS on core facing interfaces in both data plane and control plane
- configure RSVP on core facing interfaces
- Allow RSVP through control plane protection firewall filters (if any applied)
- Enable traffic engineering extensions (turned on by default in IS-IS, requires manual config in OSPF)



```sh
[edit]
root@juniper# set interfaces <interface-name> unit 0 family mpls
[edit]
root@juniper# set protocols mpls interface <interface-name>
[edit]
root@juniper# set protocols rsvp interface <interface-name>

```

Enabling RSVP doesn't itself automatically create LSPs. It simply enables the interface to talk the RSVP protocol. RSVP does not use any Transport protocol like UDP/TCP, it has its own protocol number, `46`. RSVP is IP protocol `46.

```sh
root@juniper> show rsvp interface
```

`Up` means RSVP configured on the local router, it tells nothing about the remote router.

To verify both ends of a link, use 

```sh
root@juniper> show rsvp neighbor
```

`Idle` should be `0` and both `Hello Tx/Rx` should increase.



Once we have configured RSVP LSP, to test that LSP is able to forward traffic, we can make use of MPLS self-ping which uses UDP port `8503`.